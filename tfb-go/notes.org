* Initial Setup

./db.sh IP1
./load.sh IP2
./app.sh IP3

* Running benchmarks

On app (IP3):

go get -v hello
export DBHOST=172.16.0.x (internal IP2)
hello

On load (IP2):

export LOADHOST=172.16.0.x (internal IP3)
./json.sh
./db.sh
./queries.sh 1 && ./queries.sh 5 && ./queries.sh 10 && ./queries.sh 20


* Results

** m4.4xlarge

*** json

Threads	Conns	Reqs/s	Speed	Avg Lat	Max Lat
1	1	3171.65	421.24KB	8.97ms	204.02ms
2	2	6666.06	0.86MB	297.65us	1.03ms
4	4	14318.51	1.86MB	0.95ms	202.35ms
8	8	28329.34	3.67MB	1.12ms	204.32ms
16	16	53173.65	6.90MB	550.33us	202.18ms
32	32	88373.20	11.46MB	652.93us	204.30ms
64	64	137673.88	17.86MB	672.69us	203.58ms
128	128	170790.33	22.15MB	832.43us	204.16ms

*** db

**** original

Threads	Conns	Reqs/s	Speed	Avg Lat	Max Lat
1	1	1469.75	200.63KB	677.68us	3.57ms
2	2	3009.93	410.86KB	661.26us	2.27ms
4	4	6508.17	0.87MB	611.78us	2.35ms
8	8	13741.84	1.83MB	580.68us	2.05ms
16	16	26559.41	3.54MB	600.48us	2.30ms
32	32	45226.77	6.03MB	748.44us	203.75ms
64	64	45944.75	6.12MB	1.45ms	203.71ms
128	128	45874.52	6.12MB	3.08ms	206.49ms

**** pooled random

Threads	Conns	Reqs/s	Speed	Avg Lat	Max Lat
1	1	1568.44	214.09KB	634.53us	2.91ms
2	2	2956.81	403.60KB	673.05us	2.01ms
4	4	6495.00	0.87MB	613.30us	2.23ms
8	8	13841.81	1.85MB	576.12us	2.01ms
16	16	26730.08	3.56MB	597.12us	2.14ms
32	32	45382.45	6.05MB	703.89us	3.20ms
64	64	46268.50	6.17MB	1.42ms	10.75ms
128	128	45835.41	6.11MB	3.02ms	31.95ms

**** prepared statements

http://172.16.0.104:8080/db
Threads	Conns	Reqs/s	Speed	Avg Lat	Max Lat
1	1	1492.75	203.77KB	667.23us	4.44ms
2	2	2938.07	401.05KB	677.27us	2.61ms
4	4	6505.05	0.87MB	612.78us	2.72ms
8	8	13745.92	1.83MB	580.16us	2.63ms
16	16	26605.91	3.55MB	599.98us	2.42ms
32	32	45466.27	6.06MB	702.34us	3.74ms
64	64	45903.04	6.12MB	1.43ms	10.72ms
128	128	45516.47	6.07MB	3.05ms	30.54ms


*** queries

**** 1

***** original

Threads	Conns	Reqs/s	Speed	Avg Lat	Max Lat
1	1	1598.20	221.28KB	622.67us	1.20ms
2	2	3004.15	415.93KB	662.44us	1.32ms
4	4	6317.08	0.85MB	631.22us	1.46ms
8	8	13620.21	1.84MB	585.50us	1.68ms
16	16	26084.32	3.53MB	612.92us	4.50ms
32	32	43133.20	5.83MB	751.78us	4.27ms
64	64	43775.23	5.92MB	1.50ms	9.91ms
128	128	45635.66	6.17MB	3.03ms	29.28ms

***** pooled random

Threads	Conns	Reqs/s	Speed	Avg Lat	Max Lat
1	1	1637.46	226.71KB	607.74us	1.25ms
2	2	3035.72	420.31KB	653.31us	1.51ms
4	4	6370.80	0.86MB	625.88us	1.70ms
8	8	13692.91	1.85MB	582.91us	1.57ms
16	16	26090.93	3.53MB	611.96us	2.41ms
32	32	43072.95	5.82MB	753.00us	3.90ms
64	64	43652.68	5.90MB	1.50ms	10.53ms
128	128	45646.30	6.17MB	3.03ms	27.70ms

**** 5

***** original

1	1	538.34	141.87KB	1.85ms	2.65ms
2	2	991.91	261.41KB	2.01ms	2.71ms
4	4	2191.50	577.58KB	1.82ms	2.54ms
8	8	4396.64	1.13MB	1.82ms	3.02ms
16	16	8473.49	2.18MB	1.89ms	4.34ms
32	32	9846.64	2.53MB	3.25ms	8.91ms
64	64	9481.60	2.44MB	6.73ms	22.34ms
128	128	9560.05	2.46MB	13.44ms	52.88ms

***** pooled random

Threads	Conns	Reqs/s	Speed	Avg Lat	Max Lat
1	1	542.86	143.06KB	1.84ms	2.47ms
2	2	1013.66	267.15KB	1.97ms	2.82ms
4	4	2208.73	582.11KB	1.81ms	2.86ms
8	8	4419.42	1.14MB	1.81ms	3.21ms
16	16	8483.84	2.18MB	1.88ms	4.42ms
32	32	9769.38	2.51MB	3.26ms	8.88ms
64	64	9470.70	2.44MB	6.74ms	26.68ms
128	128	9550.97	2.46MB	13.46ms	56.65ms

**** 10

***** original

Threads	Conns	Reqs/s	Speed	Avg Lat	Max Lat
1	1	34.87	14.60KB	70.10ms	612.05ms
2	2	77.94	32.63KB	66.63ms	411.06ms
4	4	227.50	95.25KB	59.65ms	616.03ms
8	8	1369.36	573.38KB	37.28ms	615.52ms
16	16	4111.32	1.68MB	13.21ms	208.60ms
32	32	4810.61	1.97MB	6.65ms	13.17ms
64	64	4745.07	1.94MB	13.41ms	34.68ms
128	128	4786.36	1.96MB	26.68ms	81.86ms

***** pooled random

Threads	Conns	Reqs/s	Speed	Avg Lat	Max Lat
1	1	295.13	123.58KB	3.38ms	3.94ms
2	2	540.19	226.18KB	3.70ms	4.50ms
4	4	1205.30	504.67KB	3.31ms	4.23ms
8	8	2410.80	0.99MB	3.31ms	4.51ms
16	16	4549.13	1.86MB	3.51ms	9.09ms
32	32	4815.95	1.97MB	6.64ms	15.09ms
64	64	4742.18	1.94MB	13.42ms	33.85ms
128	128	4785.00	1.96MB	26.67ms	73.45ms

**** 20

***** original

Threads	Conns	Reqs/s	Speed	Avg Lat	Max Lat
1	1	154.90	112.93KB	6.45ms	7.40ms
2	2	283.88	206.95KB	7.04ms	7.97ms
4	4	632.49	461.12KB	6.32ms	7.22ms
8	8	1259.90	0.90MB	6.34ms	7.74ms
16	16	2365.99	1.68MB	6.76ms	9.18ms
32	32	2387.80	1.70MB	13.39ms	21.50ms
64	64	2389.46	1.70MB	26.75ms	52.93ms
128	128	2391.89	1.70MB	53.35ms	110.32ms

***** pooled random

Threads	Conns	Reqs/s	Speed	Avg Lat	Max Lat
1	1	155.23	113.16KB	6.44ms	7.31ms
2	2	283.89	206.96KB	7.04ms	8.14ms
4	4	632.85	461.33KB	6.31ms	7.25ms
8	8	1261.72	0.90MB	6.33ms	7.67ms
16	16	2370.43	1.69MB	6.74ms	8.97ms
32	32	2387.09	1.70MB	13.40ms	23.30ms
64	64	2374.67	1.69MB	26.79ms	55.47ms
128	128	2394.01	1.70MB	53.29ms	108.96ms

***** prepared statements

Threads	Conns	Reqs/s	Speed	Avg Lat	Max Lat
1	1	151.80	110.67KB	6.58ms	7.74ms
2	2	288.01	209.96KB	6.94ms	7.97ms
4	4	624.68	455.41KB	6.40ms	7.25ms
8	8	1258.47	0.90MB	6.35ms	7.72ms
16	16	2382.20	1.70MB	6.71ms	9.28ms
32	32	2371.39	1.69MB	13.48ms	22.67ms
64	64	2359.44	1.68MB	26.98ms	52.84ms
128	128	2371.13	1.69MB	53.82ms	111.59ms


*** update

**** 1

***** original

Threads	Conns	Reqs/s	Speed	Avg Lat	Max Lat
1	1	349.31	48.36KB	2.97ms	21.99ms
2	2	781.37	108.19KB	2.71ms	15.02ms
4	4	1382.53	191.43KB	3.09ms	44.31ms
8	8	2844.12	393.78KB	2.99ms	36.51ms
16	16	5438.69	753.01KB	3.23ms	40.15ms
32	32	8416.48	1.14MB	4.08ms	57.59ms
64	64	11799.48	1.60MB	5.78ms	189.89ms
128	128	12629.00	1.71MB	10.31ms	99.29ms


***** prepared statements

Threads	Conns	Reqs/s	Speed	Avg Lat	Max Lat
1	1	372.30	51.55KB	2.82ms	40.43ms
2	2	762.52	105.58KB	2.80ms	26.99ms
4	4	1427.83	197.69KB	2.99ms	41.98ms
8	8	2748.05	380.49KB	3.27ms	116.01ms
16	16	5652.36	782.60KB	3.20ms	52.51ms
32	32	10481.72	1.42MB	3.58ms	65.31ms
64	64	16208.63	2.19MB	5.51ms	145.86ms
128	128	23571.69	3.19MB	6.36ms	296.68ms


**** 20

***** original

Threads	Conns	Reqs/s	Speed	Avg Lat	Max Lat
1	1	22.57	16.46KB	44.18ms	59.50ms
2	2	46.26	33.73KB	43.14ms	78.18ms
4	4	81.95	59.75KB	48.71ms	139.37ms
8	8	160.32	116.89KB	49.82ms	108.27ms
16	16	294.96	215.06KB	54.12ms	99.36ms
32	32	468.16	341.33KB	68.21ms	131.83ms
64	64	602.36	439.19KB	105.41ms	202.66ms
128	128	630.06	459.37KB	201.29ms	417.32ms

***** prepared statements

Threads	Conns	Reqs/s	Speed	Avg Lat	Max Lat
1	1	22.17	16.17KB	45.03ms	62.80ms
2	2	47.33	34.50KB	42.19ms	70.78ms
4	4	83.07	60.56KB	48.11ms	122.24ms
8	8	166.52	121.40KB	47.94ms	99.80ms
16	16	313.52	228.58KB	50.93ms	102.45ms
32	32	592.91	432.28KB	53.83ms	157.43ms
64	64	918.15	669.38KB	69.57ms	294.14ms
128	128	1243.36	0.89MB	102.96ms	369.58ms
